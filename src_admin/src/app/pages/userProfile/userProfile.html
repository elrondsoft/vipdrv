<div class="user-profile-template">
    <div class="row">
        <div class="col-12">
            <nav aria-label="breadcrumb" role="navigation">
                <ol class="breadcrumb user-profile-template-title-text">
                    <li class="breadcrumb-item active" aria-current="page">
                        <span translate>userProfile.userProfileMainTitle</span>
                    </li>
                </ol>
            </nav>
        </div>
    </div>
    <div class="row ng-busy-parent-container">
        <div class="col-12"
             [ngBusy]="userLoadingPromise">
            <div>
                <div class="">
                    <ul class="nav nav-tabs"
                        id="user-profile-tabs"
                        role="tablist">
                        <li class="nav-item">
                            <a id="personal-info-tab"
                               class="nav-link active"
                               href="#personalInfo"
                               data-toggle="tab"
                               role="tab"
                               aria-controls="personal-info-tab"
                               aria-expanded="true"
                               translate>
                                userProfile.tabs.personalInfo
                            </a>
                        </li>
                        <li class="nav-item">
                            <a id="avatar-tab"
                               class="nav-link"
                               href="#avatar"
                               data-toggle="tab"
                               role="tab"
                               aria-controls="avatar-tab"
                               translate>
                                userProfile.tabs.avatar
                            </a>
                        </li>
                        <li class="nav-item">
                            <a id="change-password-tab"
                               class="nav-link"
                               href="#changePassword"
                               data-toggle="tab"
                               role="tab"
                               aria-controls="change-password-tab"
                               translate>
                                userProfile.tabs.changePassword
                            </a>
                        </li>
                    </ul>
                    <div id="site-details"
                         class="tab-content">
                        <div id="personalInfo"
                             class="tab-pane fade show active"
                             role="tabpanel"
                             aria-labelledby="personal-info-tab">
                            <div class="user-profile-tab-content"
                                *ngIf="isUserDefined()">
                                <div class="row personal-info-row">
                                    <div class="col-12">
                                        <span class="personal-info-label" translate>Username:</span>
                                        {{currentUser.username}}
                                    </div>
                                </div>
                                <div class="row personal-info-row">
                                    <div class="col-12">
                                        <span class="personal-info-label" translate>Email:</span>
                                        {{currentUser.email}}
                                    </div>
                                </div>
                                <div class="row personal-info-row">
                                    <div class="col-12">
                                        <span class="personal-info-label" translate>First name:</span>
                                        {{currentUser.firstName}}
                                    </div>
                                </div>
                                <div class="row personal-info-row">
                                    <div class="col-12">
                                        <span class="personal-info-label" translate>Second name:</span>
                                        {{currentUser.secondName}}
                                    </div>
                                </div>
                                <div class="row personal-info-row">
                                    <div class="col-12">
                                        <span class="personal-info-label" translate>Max sites count:</span>
                                        {{currentUser.maxSitesCount}}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="avatar"
                             class="tab-pane fade show"
                             role="tabpanel"
                             aria-labelledby="avatar-tab">
                            <div class="user-profile-tab-content">
                                <div class="row avatar-row">
                                    <div class="col-6">
                                        <img class="rounded-circle"
                                             alt="avatar url"
                                             [src]="getAvatar()"
                                             [width]="avatarWidth"
                                             [height]="avatarHeight">
                                    </div>
                                    <div class="col-6"
                                         *ngIf="isAvatarInEditMode()">
                                        <div class="row">
                                            <div class="col-12">
                                                <img-cropper #cropper
                                                             [image]="avatarCropperData"
                                                             [settings]="avatarCropperSettings">
                                                </img-cropper>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12">
                                                <label class="custom-file">
                                                    <input type="file"
                                                           id="avatar-browse-file"
                                                           class="custom-file-input"
                                                           (change)="avatarBrowseFileChangeListener($event)">
                                                    <span class="custom-file-control"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6"
                                         *ngIf="isAvatarInEditUrlMode()">
                                        <div class="form-group">
                                            <label for="avatar-url"
                                                   translate>
                                                avatar url
                                            </label>
                                            <input id="avatar-url"
                                                   type="text"
                                                   name="avatar-url"
                                                   class="form-control"
                                                   required=""
                                                   autofocus=""
                                                   placeholder="http://www.google.com/avatar.jpg"
                                                   [(ngModel)]="stubAvatarUrl">
                                            <small id="avatar-url-help"
                                                   class="form-text text-muted"
                                                   translate>
                                                avatar url help
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                <div class="row avatar-row"
                                     *ngIf="isAvatarInViewMode()">
                                    <div class="col-12">
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatar()">
                                            <span translate>browse avatar</span>
                                        </button>
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatarUrl()">
                                            <span translate>change avatar url</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="row avatar-row"
                                     *ngIf="isAvatarInEditMode()">
                                    <div class="col-12">
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatarCommit()">
                                            <span translate>commit</span>
                                        </button>
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatarCancel()">
                                            <span translate>cancel</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="row avatar-row"
                                     *ngIf="isAvatarInEditUrlMode()">
                                    <div class="col-12">
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatarUrlCommit()">
                                            <span translate>commit</span>
                                        </button>
                                        <button type="button"
                                                class="btn btn-sm btn-secondary"
                                                (click)="editAvatarUrlCancel()">
                                            <span translate>cancel</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="row avatar-row">
                                    <div class="col-12">
                                        <button type="button"
                                                class="btn btn-primary pull-right test-drive-right-standalone-btn"
                                                (click)="saveAvatar()">
                                            <span translate>save changes</span>
                                        </button>
                                        <button type="button"
                                                class="btn btn-secondary pull-right test-drive-left-standalone-btn"
                                                (click)="resetAvatar()">
                                            <span translate>cancel</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="changePassword"
                             class="tab-pane fade show"
                             role="tabpanel"
                             aria-labelledby="change-password-tab">
                            <div class="user-profile-tab-content">
                                <div>
                                    <div class="form-group">
                                        <label for="old-password"
                                               translate>
                                            userProfile.tabs.password.oldPassword
                                        </label>
                                        <input id="old-password"
                                               type="password"
                                               name="old-password"
                                               class="form-control"
                                               required=""
                                               autofocus=""
                                               [disabled]="isAnyPasswordInputDisabled()"
                                               [(ngModel)]="oldPassword">
                                        <small id="old-password-help"
                                               class="form-text text-muted"
                                               translate>
                                            userProfile.tabs.password.oldPasswordHelp
                                        </small>
                                    </div>
                                    <div class="form-group">
                                        <label for="new-password"
                                               translate>
                                            userProfile.tabs.password.newPassword
                                        </label>
                                        <input id="new-password"
                                               type="password"
                                               name="new-password"
                                               class="form-control"
                                               required=""
                                               autofocus=""
                                               [disabled]="isAnyPasswordInputDisabled()"
                                               [(ngModel)]="newPassword">
                                        <small id="new-password-help"
                                               class="form-text text-muted"
                                               translate>
                                            userProfile.tabs.password.newPasswordHelp
                                        </small>
                                    </div>
                                    <div class="form-group">
                                        <label for="new-repeated-password"
                                               translate>
                                            userProfile.tabs.password.newRepeatedPassword
                                        </label>
                                        <input id="new-repeated-password"
                                               type="password"
                                               name="new-repeated-password"
                                               class="form-control"
                                               required=""
                                               autofocus=""
                                               [disabled]="isAnyPasswordInputDisabled()"
                                               [(ngModel)]="newRepeatedPassword">
                                        <small id="new-repeated-password-help"
                                               class="form-text text-muted"
                                               translate>
                                            userProfile.tabs.password.newRepeatedPasswordHelp
                                        </small>
                                    </div>
                                </div>
                                <div>
                                    <button type="button"
                                            [disabled]="isCommitPasswordChangeDisabled()"
                                            class="btn btn-primary pull-right"
                                            (click)="commitPasswordChange(); $event.stopPropagation();">
                                        <i class="fa fa-spinner fa-pulse" *ngIf="isCommitPasswordChangeProcessing()"></i>
                                        <i class="fa fa-check" *ngIf="!isCommitPasswordChangeProcessing()"></i>
                                        <span translate>general.actions.text_commit</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>